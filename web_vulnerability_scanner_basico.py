#!/usr/bin/env python3

import requests
from urllib.parse import urljoin

def simple_web_scanner(target_url):
    print(f"🔍 Escaneando: {target_url}")
    
    # Lista de archivos y directorios comunes
    common_paths = [
        "/admin", "/login", "/phpmyadmin", "/.git",
        "/backup", "/config", "/.env", "/robots.txt",
        "/wp-admin", "/administrator"
    ]
    
    # Headers comunes
    headers = {
        'User-Agent': 'Mozilla/5.0 (X11; Linux x86_64) Security-Scanner/1.0'
    }
    
    print("\n📂 Buscando directorios comunes...")
    for path in common_paths:
        test_url = urljoin(target_url, path)
        try:
            response = requests.get(test_url, headers=headers, timeout=5)
            if response.status_code == 200:
                print(f"✅ ENCONTRADO: {test_url} (Status: {response.status_code})")
            elif response.status_code == 403:
                print(f"🔒 ACCESO DENEGADO: {test_url}")
        except:
            pass
    
    # Verificar información del servidor
    print("\n🖥️  Información del servidor...")
    try:
        response = requests.head(target_url, headers=headers, timeout=5)
        server = response.headers.get('Server', 'No encontrado')
        print(f"Servidor: {server}")
    except Exception as e:
        print(f"Error: {e}")

if __name__ == "__main__":
    target="https://"
    target += input("Ingresa la URL a escanear (ej: http://localhost): ")
    simple_web_scanner(target)